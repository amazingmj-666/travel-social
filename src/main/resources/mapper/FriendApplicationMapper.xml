<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wmj.design.travelsocial.dao.FriendApplicationMapper">
   <!-- <resultMap type="com.wmj.design.travelsocial.domain.social.FriendApplication" id="FriendApplicationResult">
        <result property="id"    column="id"    />
        <result property="applicationId"    column="application_id"    />
        <result property="beAddId"    column="be_add_id"    />
        <result property="message"    column="message"    />
        <result property="status"    column="status"    />
        <result property="createTime"    column="create_time"    />
    </resultMap>-->

    <insert id="insertFriendApplication" parameterType="com.wmj.design.travelsocial.domain.social.FriendApplication"
            useGeneratedKeys="true" keyProperty="id">
        INSERT into friend_application(application_id,be_add_id,message) values (#{applicationId},#{beAddId},#{message})
    </insert>
    <select id="selectFriendApplicationCountByBeAddId" parameterType="com.wmj.design.travelsocial.domain.social.FriendApplication"
            resultType="int">
      SELECT count(*) FROM friend_application WHERE be_add_id = #{id} and status = '0'
    </select>
    <select id="selectFriendApplicationList" parameterType="com.wmj.design.travelsocial.domain.social.FriendApplication"
                     resultType="com.wmj.design.travelsocial.domain.social.FriendApplication">
         SELECT * FROM friend_application WHERE be_add_id = #{beAddId} and status = #{status}
        <!--<where>
            <if test="id != null "> and id = #{id}</if>
            <if test="applicationId != null  and applicationId != '' "> and application_id = #{applicationId}</if>
            <if test="beAddId != null ">and be_add_id = #{beAddId}</if>
            <if test="message != null  and message != '' "> and message = #{message}</if>
            <if test="createTime != null  and createTime != '' "> and create_time = #{createTime}</if>
            <if test="status != null  and status != '' ">and status = #{status}</if>
        </where>-->
    </select>
    <update id="updateFriendApplicationStatus" parameterType="com.wmj.design.travelsocial.domain.social.FriendApplication">
        UPDATE friend_application
        <trim prefix="set" suffixOverrides=",">
            <if test="status!=null">status=#{status},</if>
        </trim>
        WHERE application_id=#{applicationId} and be_add_id=#{beAddId}
    </update>
    <select id="selectFriendApplicationIsExist" parameterType="com.wmj.design.travelsocial.domain.social.FriendApplication"
            resultType="com.wmj.design.travelsocial.domain.social.FriendApplication">
      SELECT * FROM friend_application WHERE application_id = #{applicationId} and be_add_id = #{beAddId} and status &lt;2
      or application_id = #{beAddId} and be_add_id = #{applicationId} and status &lt;2
    </select>
</mapper>
